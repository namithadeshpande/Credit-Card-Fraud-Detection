

```{r logistic upsampled}

# Upsample Test Data
set.seed(12345)
up_test <- upSample(x = test.data[, -30], y = test.data$Class)

table(up_test$Class)

logit.reg <- glm(Class ~ ., data = up_train, family = "binomial")
options(scipen = 999) 
summary(logit.reg)

#Generate odds ratio
exp(coef(logit.reg))

#performance evaluation
logit.reg.pred <- predict(logit.reg, up_test, type = "response")

t(t(head(logit.reg.pred, 10)))

#confusion matrix
table(up_test$Class, logit.reg.pred > 0.5)

summary(logit.reg.pred)

acc2<-table(logit.reg.pred > 0.5, up_test$Class)
print("Confusion Matrix for Test Data")
acc2

#Precision score 
precision <- acc2[2,2]/(acc2[2,2]+acc2[2,1])
precision

#Recall
recall <- acc2[2,2]/(acc2[2,2]+acc2[1,2])
recall

#Specificity
specificity <- acc2[1,1]/(acc2[1,1]+acc2[2,1])
specificity

#F Score
fscore <- (precision*recall)/(precision+recall)
fscore


print('ROC')
roc.curve(up_test$Class, logit.reg.pred, plotit = TRUE)

```

